import{M as k}from"./modal-16e3b0b7.js";import{_ as p,o as r,b as u,e as t,t as c,s as n,u as _,T as U,U as w,n as h,w as b,F as v,d as x,r as f,f as g}from"./index-4c7074af.js";import"./base-component-a6d80b1b.js";import"./selector-engine-e26b3bd8.js";import"./focustrap-6fa3c158.js";import"./component-functions-451bdf8f.js";const{VITE_URL:$,VITE_PATH:M}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"neil-hexschool",BASE_URL:"/CNC-Website-Project/",MODE:"production",DEV:!1,PROD:!0},C={props:["getProducts","isNew"],data(){return{productModal:"",data:{}}},methods:{updateProduct(){let l=`${$}/v2/api/${M}/admin/product`,e="post";this.isNew===!1&&(l=`${$}/v2/api/${M}/admin/product/${this.data.id}`,e="put"),this.$http[e](l,{data:this.data}).then(()=>{this.productModal.hide(),this.getProducts()}).catch(()=>{})}},mounted(){this.productModal=new k(this.$refs.modal)}},N={class:"modal fade",id:"exampleModal2",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},I={class:"modal-dialog modal-lg"},L={class:"modal-content"},A={class:"modal-header bg-dark"},D={class:"modal-title text-light",id:"exampleModalLabel"},R=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},B={class:"container-fluid"},O={class:"row"},j={class:"col-4"},S=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),W=["src"],z={class:"col-8"},F={class:"mb-3"},q=t("label",{for:"productName",class:"form-label"},"商品名稱",-1),G={class:"row mb-3"},J={class:"col"},K=t("label",{for:"category",class:"form-label"},"類別",-1),Q={class:"col"},X=t("label",{for:"unit",class:"form-label"},"單位",-1),Y={class:"row mb-3"},Z={class:"col"},tt=t("label",{for:"originPrice",class:"form-label"},"原價",-1),et={class:"col"},st=t("label",{for:"price",class:"form-label"},"售價",-1),ot=t("hr",null,null,-1),lt={class:"mb-3"},at=t("label",{for:"description",class:"form-label"},"商品描述",-1),dt={class:"mb-3"},it=t("label",{for:"content",class:"form-label"},"內容",-1),nt={class:"form-check"},ct=t("label",{class:"form-check-label",for:"isEnable"}," 是否啟用 ",-1),rt={class:"modal-footer"},ut=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function _t(l,e,a,m,o,d){return r(),u("div",N,[t("div",I,[t("div",L,[t("div",A,[t("h4",D,c(a.isNew?"新增商品":"修改商品"),1),R]),t("div",H,[t("div",B,[t("div",O,[t("div",j,[t("div",null,[S,n(t("input",{type:"email",class:"form-control",id:"imageUrl","onUpdate:modelValue":e[0]||(e[0]=s=>o.data.imageUrl=s),placeholder:"請輸入網址"},null,512),[[_,o.data.imageUrl]])]),o.data.imageUrl?(r(),u("img",{key:0,class:"img-fluid",src:o.data.imageUrl,alt:"產品圖片"},null,8,W)):U("",!0)]),t("div",z,[t("div",F,[q,n(t("input",{type:"email",class:"form-control",id:"productName","onUpdate:modelValue":e[1]||(e[1]=s=>o.data.title=s),placeholder:"請輸入名稱"},null,512),[[_,o.data.title]])]),t("div",G,[t("div",J,[K,n(t("input",{type:"email",class:"form-control",id:"category","onUpdate:modelValue":e[2]||(e[2]=s=>o.data.category=s),placeholder:"請輸入類別"},null,512),[[_,o.data.category]])]),t("div",Q,[X,n(t("input",{type:"email",class:"form-control",id:"unit","onUpdate:modelValue":e[3]||(e[3]=s=>o.data.unit=s),placeholder:"請輸入單位"},null,512),[[_,o.data.unit]])])]),t("div",Y,[t("div",Z,[tt,n(t("input",{type:"email",class:"form-control",id:"originPrice","onUpdate:modelValue":e[4]||(e[4]=s=>o.data.origin_price=s),placeholder:"請輸入原價"},null,512),[[_,o.data.origin_price,void 0,{number:!0}]])]),t("div",et,[st,n(t("input",{type:"email",class:"form-control",id:"price","onUpdate:modelValue":e[5]||(e[5]=s=>o.data.price=s),placeholder:"請輸入售價"},null,512),[[_,o.data.price,void 0,{number:!0}]])])]),ot,t("div",lt,[at,n(t("textarea",{class:"form-control",id:"description",rows:"2","onUpdate:modelValue":e[6]||(e[6]=s=>o.data.description=s)},null,512),[[_,o.data.description]])]),t("div",dt,[it,n(t("textarea",{class:"form-control",id:"content",rows:"2","onUpdate:modelValue":e[7]||(e[7]=s=>o.data.content=s)},null,512),[[_,o.data.content]])]),t("div",nt,[n(t("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[8]||(e[8]=s=>o.data.is_enabled=s),id:"isEnable"},null,512),[[w,o.data.is_enabled]]),ct])])])])]),t("div",rt,[ut,t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=s=>d.updateProduct())},"確認")])])])],512)}const ht=p(C,[["render",_t]]),{VITE_URL:pt,VITE_PATH:mt}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"neil-hexschool",BASE_URL:"/CNC-Website-Project/",MODE:"production",DEV:!1,PROD:!0},bt={props:["getProducts"],data(){return{deleteModal:"",data:{}}},methods:{deleteProduct(){this.$http.delete(`${pt}/v2/api/${mt}/admin/product/${this.data.id}`).then(()=>{this.getProducts(),this.deleteModal.hide()}).catch(()=>{})}},mounted(){this.deleteModal=new k(this.$refs.delModal)}},ft={class:"modal fade",id:"delModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"delModal"},gt={class:"modal-dialog"},vt={class:"modal-content"},Pt=t("div",{class:"modal-header bg-danger"},[t("h4",{class:"modal-title text-light",id:"exampleModalLabel"},"刪除商品"),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$t={class:"modal-body"},Mt={class:"modal-footer"},yt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function kt(l,e,a,m,o,d){return r(),u("div",ft,[t("div",gt,[t("div",vt,[Pt,t("div",$t,[t("p",null,c(o.data.title),1)]),t("div",Mt,[yt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=s=>d.deleteProduct())},"確定刪除")])])])],512)}const xt=p(bt,[["render",kt]]),Vt={props:["pages","getProducts"]},Et={"aria-label":"Page navigation example"},Tt={class:"pagination justify-content-end"},Ut=t("span",{"aria-hidden":"true"},"«",-1),wt=[Ut],Ct=["onClick"],Nt=t("span",{"aria-hidden":"true"},"»",-1),It=[Nt];function Lt(l,e,a,m,o,d){return r(),u("nav",Et,[t("ul",Tt,[t("li",{class:h(["page-item",{disabled:!a.pages.has_pre}])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=b(s=>a.getProducts(a.pages.current_page-1),["prevent"]))},wt)],2),(r(!0),u(v,null,x(a.pages.total_pages,s=>(r(),u("li",{class:"page-item",key:s+1234},[t("a",{class:h(["page-link",{active:s===a.pages.current_page}]),href:"#",onClick:b(P=>a.getProducts(s),["prevent"])},c(s),11,Ct)]))),128)),t("li",{class:h(["page-item",{disabled:!a.pages.has_next}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=b(s=>a.getProducts(a.pages.current_page+1),["prevent"]))},It)],2)])])}const At=p(Vt,[["render",Lt]]),{VITE_URL:y,VITE_PATH:Dt}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"neil-hexschool",BASE_URL:"/CNC-Website-Project/",MODE:"production",DEV:!1,PROD:!0},Rt={data(){return{products:[],isNew:!1,pages:""}},components:{ProductModal:ht,DeleteModal:xt,PagiNation:At},methods:{checkAdmin(){this.$http.post(`${y}/v2/api/user/check`).then(()=>{this.getProducts()}).catch(()=>{this.$router.push("/login")})},getProducts(l=1){this.$http.get(`${y}/v2/api/${Dt}/admin/products/?page=${l}`).then(e=>{this.products=e.data.products,this.pages=e.data.pagination})},openModal(l,e){l==="add"?(this.isNew=!0,this.$refs.modal.data={},this.$refs.modal.productModal.show()):l==="put"?(this.isNew=!1,this.$refs.modal.data={...e},this.$refs.modal.productModal.show()):l==="del"&&(this.$refs.delModal.data={...e},this.$refs.delModal.deleteModal.show())}},mounted(){const l=document.cookie.replace(/(?:(?:^|.*;\s*)CookieToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=l,this.checkAdmin()}},Ht={class:"d-flex justify-content-between align-items-center py-4"},Bt=t("h2",{class:"fs-1 lh-base m-0"},"商品列表",-1),Ot={class:"table table-hover border align-middle"},jt=t("thead",null,[t("tr",{class:"table-dark"},[t("th",null,"項次"),t("th",null,"類別"),t("th",null,"商品名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",null,"是否啟用"),t("th",null,"操作")])],-1),St={class:"btn-group",role:"group","aria-label":"Basic example"},Wt=["onClick"],zt=["onClick"];function Ft(l,e,a,m,o,d){const s=f("PagiNation"),P=f("ProductModal"),V=f("DeleteModal");return r(),u(v,null,[t("div",Ht,[Bt,t("button",{type:"button",class:"btn btn-outline-primary",onClick:e[0]||(e[0]=i=>d.openModal("add"))},"新增商品")]),t("table",Ot,[jt,t("tbody",null,[(r(!0),u(v,null,x(o.products,(i,E)=>(r(),u("tr",{key:i.id},[t("td",null,c(E+1),1),t("td",null,c(i.category),1),t("td",null,c(i.title),1),t("td",null,c(i.origin_price),1),t("td",null,c(i.price),1),t("td",{class:h([{"text-success":i.is_enabled},{"text-danger":!i.is_enabled}])},c(i.is_enabled?"啟用":"未啟用"),3),t("td",null,[t("div",St,[t("button",{type:"button",class:"btn btn-dark",onClick:T=>d.openModal("put",i)},"編輯",8,Wt),t("button",{type:"button",class:"btn btn-danger",onClick:T=>d.openModal("del",i)},"刪除",8,zt)])])]))),128))])]),g(s,{pages:o.pages,"get-products":d.getProducts},null,8,["pages","get-products"]),g(P,{ref:"modal","get-products":d.getProducts,"is-new":o.isNew},null,8,["get-products","is-new"]),g(V,{ref:"delModal","get-products":d.getProducts},null,8,["get-products"])],64)}const Yt=p(Rt,[["render",Ft]]);export{Yt as default};
