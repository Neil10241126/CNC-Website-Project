import{c as ut,_ as $,o as m,b as p,e as t,s as _,S as g,T as ht,U as _t,t as b,n as k,w as C,F as L,d as H,r as D,f as V}from"./index-9e9c9e42.js";import{r as mt,a as pt,b as ft}from"./base-component-4da5757e.js";import{r as gt}from"./selector-engine-b59dbf06.js";import{r as bt,a as Et,b as vt}from"./focustrap-5e168a69.js";import{r as yt}from"./component-functions-404a8237.js";var S={},Tt={get exports(){return S},set exports(n){S=n}};/*!
  * Bootstrap modal.js v5.2.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(n,e){(function(l,E){n.exports=E(mt(),pt(),gt(),bt(),ft(),Et(),vt(),yt())})(ut,function(l,E,i,r,s,w,A,c){const f=y=>y&&typeof y=="object"&&"default"in y?y:{default:y},d=f(E),P=f(i),q=f(r),Y=f(s),W=f(w),F=f(A),K="modal",u=".bs.modal",z=".data-api",G="Escape",Q=`hide${u}`,J=`hidePrevented${u}`,N=`hidden${u}`,x=`show${u}`,Z=`shown${u}`,X=`resize${u}`,tt=`click.dismiss${u}`,et=`mousedown.dismiss${u}`,st=`keydown.dismiss${u}`,ot=`click${u}${z}`,I="modal-open",it="fade",O="show",M="modal-static",lt=".modal.show",nt=".modal-dialog",at=".modal-body",dt='[data-bs-toggle="modal"]',rt={backdrop:!0,focus:!0,keyboard:!0},ct={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class v extends Y.default{constructor(o,a){super(o,a),this._dialog=P.default.findOne(nt,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new q.default,this._addEventListeners()}static get Default(){return rt}static get DefaultType(){return ct}static get NAME(){return K}toggle(o){return this._isShown?this.hide():this.show(o)}show(o){this._isShown||this._isTransitioning||d.default.trigger(this._element,x,{relatedTarget:o}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(I),this._adjustDialog(),this._backdrop.show(()=>this._showElement(o)))}hide(){!this._isShown||this._isTransitioning||d.default.trigger(this._element,Q).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(O),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const o of[window,this._dialog])d.default.off(o,u);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new W.default({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new F.default({trapElement:this._element})}_showElement(o){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const a=P.default.findOne(at,this._dialog);a&&(a.scrollTop=0),l.reflow(this._element),this._element.classList.add(O);const h=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,d.default.trigger(this._element,Z,{relatedTarget:o})};this._queueCallback(h,this._dialog,this._isAnimated())}_addEventListeners(){d.default.on(this._element,st,o=>{if(o.key===G){if(this._config.keyboard){o.preventDefault(),this.hide();return}this._triggerBackdropTransition()}}),d.default.on(window,X,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),d.default.on(this._element,et,o=>{d.default.one(this._element,tt,a=>{if(!(this._element!==o.target||this._element!==a.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(I),this._resetAdjustments(),this._scrollBar.reset(),d.default.trigger(this._element,N)})}_isAnimated(){return this._element.classList.contains(it)}_triggerBackdropTransition(){if(d.default.trigger(this._element,J).defaultPrevented)return;const a=this._element.scrollHeight>document.documentElement.clientHeight,h=this._element.style.overflowY;h==="hidden"||this._element.classList.contains(M)||(a||(this._element.style.overflowY="hidden"),this._element.classList.add(M),this._queueCallback(()=>{this._element.classList.remove(M),this._queueCallback(()=>{this._element.style.overflowY=h},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const o=this._element.scrollHeight>document.documentElement.clientHeight,a=this._scrollBar.getWidth(),h=a>0;if(h&&!o){const T=l.isRTL()?"paddingLeft":"paddingRight";this._element.style[T]=`${a}px`}if(!h&&o){const T=l.isRTL()?"paddingRight":"paddingLeft";this._element.style[T]=`${a}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(o,a){return this.each(function(){const h=v.getOrCreateInstance(this,o);if(typeof o=="string"){if(typeof h[o]>"u")throw new TypeError(`No method named "${o}"`);h[o](a)}})}}return d.default.on(document,ot,dt,function(y){const o=l.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&y.preventDefault(),d.default.one(o,x,T=>{T.defaultPrevented||d.default.one(o,N,()=>{l.isVisible(this)&&this.focus()})});const a=P.default.findOne(lt);a&&v.getInstance(a).hide(),v.getOrCreateInstance(o).toggle(this)}),c.enableDismissTrigger(v),l.defineJQueryPlugin(v),v})})(Tt);const j=S,{VITE_URL:U,VITE_PATH:R}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"neil-hexschool",BASE_URL:"/CNC-Website-Project/",MODE:"production",DEV:!1,PROD:!0},wt={props:["getProducts","isNew"],data(){return{productModal:"",data:{}}},methods:{updateProduct(){let n=`${U}/v2/api/${R}/admin/product`,e="post";this.isNew===!1&&(n=`${U}/v2/api/${R}/admin/product/${this.data.id}`,e="put"),this.$http[e](n,{data:this.data}).then(()=>{this.productModal.hide(),this.getProducts()}).catch(()=>{})}},mounted(){this.productModal=new j(this.$refs.modal)}},kt={class:"modal fade",id:"exampleModal2",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},$t={class:"modal-dialog modal-lg"},At={class:"modal-content"},Pt=t("div",{class:"modal-header bg-dark"},[t("h4",{class:"modal-title text-light",id:"exampleModalLabel"},"新增商品"),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mt={class:"modal-body"},Ct={class:"container-fluid"},Dt={class:"row"},Vt={class:"col-4"},Lt=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),St=["src"],Nt={class:"col-8"},xt={class:"mb-3"},It=t("label",{for:"productName",class:"form-label"},"商品名稱",-1),Ot={class:"row mb-3"},Ut={class:"col"},Rt=t("label",{for:"category",class:"form-label"},"類別",-1),Bt={class:"col"},Ht=t("label",{for:"unit",class:"form-label"},"單位",-1),jt={class:"row mb-3"},qt={class:"col"},Yt=t("label",{for:"originPrice",class:"form-label"},"原價",-1),Wt={class:"col"},Ft=t("label",{for:"price",class:"form-label"},"售價",-1),Kt=t("hr",null,null,-1),zt={class:"mb-3"},Gt=t("label",{for:"description",class:"form-label"},"商品描述",-1),Qt={class:"mb-3"},Jt=t("label",{for:"content",class:"form-label"},"內容",-1),Zt={class:"form-check"},Xt=t("label",{class:"form-check-label",for:"isEnable"}," 是否啟用 ",-1),te={class:"modal-footer"},ee=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function se(n,e,l,E,i,r){return m(),p("div",kt,[t("div",$t,[t("div",At,[Pt,t("div",Mt,[t("div",Ct,[t("div",Dt,[t("div",Vt,[t("div",null,[Lt,_(t("input",{type:"email",class:"form-control",id:"imageUrl","onUpdate:modelValue":e[0]||(e[0]=s=>i.data.imageUrl=s),placeholder:"請輸入網址"},null,512),[[g,i.data.imageUrl]])]),i.data.imageUrl?(m(),p("img",{key:0,class:"img-fluid",src:i.data.imageUrl,alt:"產品圖片"},null,8,St)):ht("",!0)]),t("div",Nt,[t("div",xt,[It,_(t("input",{type:"email",class:"form-control",id:"productName","onUpdate:modelValue":e[1]||(e[1]=s=>i.data.title=s),placeholder:"請輸入名稱"},null,512),[[g,i.data.title]])]),t("div",Ot,[t("div",Ut,[Rt,_(t("input",{type:"email",class:"form-control",id:"category","onUpdate:modelValue":e[2]||(e[2]=s=>i.data.category=s),placeholder:"請輸入類別"},null,512),[[g,i.data.category]])]),t("div",Bt,[Ht,_(t("input",{type:"email",class:"form-control",id:"unit","onUpdate:modelValue":e[3]||(e[3]=s=>i.data.unit=s),placeholder:"請輸入單位"},null,512),[[g,i.data.unit]])])]),t("div",jt,[t("div",qt,[Yt,_(t("input",{type:"email",class:"form-control",id:"originPrice","onUpdate:modelValue":e[4]||(e[4]=s=>i.data.origin_price=s),placeholder:"請輸入原價"},null,512),[[g,i.data.origin_price,void 0,{number:!0}]])]),t("div",Wt,[Ft,_(t("input",{type:"email",class:"form-control",id:"price","onUpdate:modelValue":e[5]||(e[5]=s=>i.data.price=s),placeholder:"請輸入售價"},null,512),[[g,i.data.price,void 0,{number:!0}]])])]),Kt,t("div",zt,[Gt,_(t("textarea",{class:"form-control",id:"description",rows:"2","onUpdate:modelValue":e[6]||(e[6]=s=>i.data.description=s)},null,512),[[g,i.data.description]])]),t("div",Qt,[Jt,_(t("textarea",{class:"form-control",id:"content",rows:"2","onUpdate:modelValue":e[7]||(e[7]=s=>i.data.content=s)},null,512),[[g,i.data.content]])]),t("div",Zt,[_(t("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[8]||(e[8]=s=>i.data.is_enabled=s),id:"isEnable"},null,512),[[_t,i.data.is_enabled]]),Xt])])])])]),t("div",te,[ee,t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=s=>r.updateProduct())},"確認")])])])],512)}const oe=$(wt,[["render",se]]),{VITE_URL:ie,VITE_PATH:le}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"neil-hexschool",BASE_URL:"/CNC-Website-Project/",MODE:"production",DEV:!1,PROD:!0},ne={props:["getProducts"],data(){return{deleteModal:"",data:{}}},methods:{deleteProduct(){this.$http.delete(`${ie}/v2/api/${le}/admin/product/${this.data.id}`).then(()=>{this.getProducts(),this.deleteModal.hide()}).catch(()=>{})}},mounted(){this.deleteModal=new j(this.$refs.delModal)}},ae={class:"modal fade",id:"delModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"delModal"},de={class:"modal-dialog"},re={class:"modal-content"},ce=t("div",{class:"modal-header bg-danger"},[t("h4",{class:"modal-title text-light",id:"exampleModalLabel"},"刪除商品"),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ue={class:"modal-body"},he={class:"modal-footer"},_e=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function me(n,e,l,E,i,r){return m(),p("div",ae,[t("div",de,[t("div",re,[ce,t("div",ue,[t("p",null,b(i.data.title),1)]),t("div",he,[_e,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=s=>r.deleteProduct())},"確定刪除")])])])],512)}const pe=$(ne,[["render",me]]),fe={props:["pages","getProducts"]},ge={"aria-label":"Page navigation example"},be={class:"pagination justify-content-end"},Ee=t("span",{"aria-hidden":"true"},"«",-1),ve=[Ee],ye=["onClick"],Te=t("span",{"aria-hidden":"true"},"»",-1),we=[Te];function ke(n,e,l,E,i,r){return m(),p("nav",ge,[t("ul",be,[t("li",{class:k(["page-item",{disabled:!l.pages.has_pre}])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=C(s=>l.getProducts(l.pages.current_page-1),["prevent"]))},ve)],2),(m(!0),p(L,null,H(l.pages.total_pages,s=>(m(),p("li",{class:"page-item",key:s+1234},[t("a",{class:k(["page-link",{active:s===l.pages.current_page}]),href:"#",onClick:C(w=>l.getProducts(s),["prevent"])},b(s),11,ye)]))),128)),t("li",{class:k(["page-item",{disabled:!l.pages.has_next}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=C(s=>l.getProducts(l.pages.current_page+1),["prevent"]))},we)],2)])])}const $e=$(fe,[["render",ke]]),{VITE_URL:B,VITE_PATH:Ae}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"neil-hexschool",BASE_URL:"/CNC-Website-Project/",MODE:"production",DEV:!1,PROD:!0},Pe={data(){return{products:[],isNew:!1,pages:""}},components:{ProductModal:oe,DeleteModal:pe,PagiNation:$e},methods:{checkAdmin(){this.$http.post(`${B}/v2/api/user/check`).then(()=>{this.getProducts()}).catch(()=>{this.$router.push("/login")})},getProducts(n=1){this.$http.get(`${B}/v2/api/${Ae}/admin/products/?page=${n}`).then(e=>{this.products=e.data.products,this.pages=e.data.pagination})},openModal(n,e){n==="add"?(this.isNew=!0,this.$refs.modal.data={},this.$refs.modal.productModal.show()):n==="put"?(this.isNew=!1,this.$refs.modal.data={...e},this.$refs.modal.productModal.show()):n==="del"&&(this.$refs.delModal.data={...e},this.$refs.delModal.deleteModal.show())}},mounted(){const n=document.cookie.replace(/(?:(?:^|.*;\s*)CookieToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=n,this.checkAdmin()}},Me={class:"d-flex justify-content-between align-items-center py-4"},Ce=t("h2",{class:"fs-1 lh-base m-0"},"商品列表",-1),De={class:"table table-hover border align-middle"},Ve=t("thead",null,[t("tr",{class:"table-dark"},[t("th",null,"項次"),t("th",null,"類別"),t("th",null,"商品名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",null,"是否啟用"),t("th",null,"操作")])],-1),Le={class:"btn-group",role:"group","aria-label":"Basic example"},Se=["onClick"],Ne=["onClick"];function xe(n,e,l,E,i,r){const s=D("PagiNation"),w=D("ProductModal"),A=D("DeleteModal");return m(),p(L,null,[t("div",Me,[Ce,t("button",{type:"button",class:"btn btn-outline-primary",onClick:e[0]||(e[0]=c=>r.openModal("add"))},"新增商品")]),t("table",De,[Ve,t("tbody",null,[(m(!0),p(L,null,H(i.products,(c,f)=>(m(),p("tr",{key:c.id},[t("td",null,b(f+1),1),t("td",null,b(c.category),1),t("td",null,b(c.title),1),t("td",null,b(c.origin_price),1),t("td",null,b(c.price),1),t("td",{class:k([{"text-success":c.is_enabled},{"text-danger":!c.is_enabled}])},b(c.is_enabled?"啟用":"未啟用"),3),t("td",null,[t("div",Le,[t("button",{type:"button",class:"btn btn-info",onClick:d=>r.openModal("put",c)},"編輯",8,Se),t("button",{type:"button",class:"btn btn-danger",onClick:d=>r.openModal("del",c)},"刪除",8,Ne)])])]))),128))])]),V(s,{pages:i.pages,"get-products":r.getProducts},null,8,["pages","get-products"]),V(w,{ref:"modal","get-products":r.getProducts,"is-new":i.isNew},null,8,["get-products","is-new"]),V(A,{ref:"delModal","get-products":r.getProducts},null,8,["get-products"])],64)}const je=$(Pe,[["render",xe]]);export{je as default};
